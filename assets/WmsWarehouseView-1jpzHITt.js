import{E as O}from"./el-button-Vc6VEKII.js";import{b as A,c as $,e as j,f as R,h as X}from"./el-table-column-DnVx5bAE.js";import{E as G}from"./el-tag-H94PFL3m.js";import{b as H,E as J,a as Q}from"./el-input-CFf0CTHR.js";import{E as Y}from"./el-card-CgDv5Emn.js";import{d as Z,p as g,C as ee,g as E,w as n,s as f,t as e,y as ae,v as C,f as te,ar as oe,X as ne,x as c,F as z,E as le,k as w,aD as se,as as re,aE as ue,b5 as ie,z as s,o as h,B as ce}from"./index-ClAeb_nj.js";import{P as pe}from"./PageLayout-2dU49uLu.js";import{z as de,A as me,B as _e,C as I}from"./api-D03_kbYf.js";import"./mockData-C7SYYOmC.js";const ge={class:"wms-warehouse"},we={class:"action-buttons"},fe={class:"pagination-container"},he=Z({__name:"WmsWarehouseView",setup(ve){const r=g({productName:"",sku:"",warehouseId:void 0}),l=g({page:1,pageSize:10,total:0}),v=g([]),p=g([]),V=async()=>{try{const t=await de({page:1,pageSize:100});v.value=t.list}catch{s.error("获取仓库列表失败")}},i=async()=>{try{const t={productName:r.value.productName,sku:r.value.sku,warehouseId:r.value.warehouseId,page:l.value.page,pageSize:l.value.pageSize},a=await me(t);p.value=a.list,l.value.total=a.total}catch{s.error("获取库存列表失败")}},d=async()=>{l.value.page=1,await i()},x=async()=>{r.value={productName:"",sku:"",warehouseId:void 0},l.value.page=1,await i()},N=async t=>{l.value.pageSize=t,await i()},U=async t=>{l.value.page=t,await i()},B=async()=>{try{const t={warehouseId:1,productName:"测试商品",sku:"TEST"+Date.now(),quantity:100,minStock:10,maxStock:200};await _e(t),s.success("入库成功"),await i()}catch(t){s.error("入库失败: "+t.message)}},T=async()=>{try{if(p.value.length===0){s.warning("没有可出库的库存");return}const t=p.value[0];if(!t){s.warning("没有可出库的库存");return}const a={...t,quantity:Math.max(0,t.quantity-1)};await I(a),s.success("出库成功"),await i()}catch(t){s.error("出库失败: "+t.message)}},W=async t=>{try{const a={...t,quantity:t.quantity+10};await I(a),s.success("库存更新成功"),await i()}catch(a){s.error("库存更新失败: "+a.message)}},q=t=>{s.info("查看库存日志功能开发中")};return ee(async()=>{await V(),await i()}),(t,a)=>{const y=Q,m=J,K=X,F=A,_=O,L=H,k=Y,u=j,b=G,S=le,M=$,D=R;return h(),E(pe,{title:"WMS仓库管理",actions:[{type:"primary",text:"入库",icon:w(ue),onClick:B},{type:"warning",text:"出库",icon:w(ie),onClick:T}]},{default:n(()=>[f("div",ge,[e(k,{shadow:"never",class:"search-form"},{default:n(()=>[e(L,{inline:!0,onSubmit:ae(d,["prevent"])},{default:n(()=>[e(m,{label:"商品名称"},{default:n(()=>[e(y,{modelValue:r.value.productName,"onUpdate:modelValue":a[0]||(a[0]=o=>r.value.productName=o),placeholder:"请输入商品名称",clearable:"",onKeyup:C(d,["enter"])},null,8,["modelValue"])]),_:1}),e(m,{label:"商品SKU"},{default:n(()=>[e(y,{modelValue:r.value.sku,"onUpdate:modelValue":a[1]||(a[1]=o=>r.value.sku=o),placeholder:"请输入商品SKU",clearable:"",onKeyup:C(d,["enter"])},null,8,["modelValue"])]),_:1}),e(m,{label:"仓库"},{default:n(()=>[e(F,{modelValue:r.value.warehouseId,"onUpdate:modelValue":a[2]||(a[2]=o=>r.value.warehouseId=o),placeholder:"请选择仓库",clearable:""},{default:n(()=>[(h(!0),te(ne,null,oe(v.value,o=>(h(),E(K,{key:o.id,label:o.name,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(m,null,{default:n(()=>[e(_,{type:"primary",onClick:d},{default:n(()=>[...a[5]||(a[5]=[c("搜索",-1)])]),_:1}),e(_,{onClick:x},{default:n(()=>[...a[6]||(a[6]=[c("重置",-1)])]),_:1})]),_:1})]),_:1})]),_:1}),e(k,{shadow:"never",class:"table-container"},{default:n(()=>[e(M,{data:p.value,stripe:"",style:{width:"100%"}},{default:n(()=>[e(u,{prop:"id",label:"ID",width:"60",align:"center"}),e(u,{prop:"productName",label:"商品名称","min-width":"200"}),e(u,{prop:"sku",label:"商品SKU",width:"150",align:"center"}),e(u,{prop:"warehouseName",label:"仓库",width:"120",align:"center"},{default:n(o=>[e(b,{type:"primary"},{default:n(()=>[c(z(o.row.warehouseName),1)]),_:2},1024)]),_:1}),e(u,{prop:"quantity",label:"当前库存",width:"120",align:"center"}),e(u,{prop:"minStock",label:"安全库存",width:"120",align:"center"}),e(u,{prop:"maxStock",label:"最大库存",width:"120",align:"center"}),e(u,{prop:"status",label:"状态",width:"120",align:"center"},{default:n(o=>[e(b,{type:{normal:"success",low:"danger",high:"warning"}[o.row.status]},{default:n(()=>[c(z({normal:"正常",low:"库存不足",high:"库存溢出"}[o.row.status]),1)]),_:2},1032,["type"])]),_:1}),e(u,{prop:"updatedAt",label:"最后更新",width:"180"}),e(u,{label:"操作",width:"240",fixed:"right",align:"center"},{default:n(o=>[f("div",we,[e(_,{type:"primary",size:"small",onClick:P=>W(o.row)},{default:n(()=>[e(S,null,{default:n(()=>[e(w(se))]),_:1}),a[7]||(a[7]=c(" 编辑库存 ",-1))]),_:1},8,["onClick"]),e(_,{type:"info",size:"small",onClick:P=>q(o.row)},{default:n(()=>[e(S,null,{default:n(()=>[e(w(re))]),_:1}),a[8]||(a[8]=c(" 库存日志 ",-1))]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["data"])]),_:1}),f("div",fe,[e(D,{"current-page":l.value.page,"onUpdate:currentPage":a[3]||(a[3]=o=>l.value.page=o),"page-size":l.value.pageSize,"onUpdate:pageSize":a[4]||(a[4]=o=>l.value.pageSize=o),"page-sizes":[10,20,50,100],total:l.value.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:N,onCurrentChange:U},null,8,["current-page","page-size","total"])])])]),_:1},8,["actions"])}}}),xe=ce(he,[["__scopeId","data-v-9cb8dd41"]]);export{xe as default};
