import{E as M}from"./el-button-DVrV4cDQ.js";import{b as U,h as $,c as N,e as A,f as K}from"./el-table-column-BBRnyYHQ.js";import{E as L}from"./el-tag-fQWpZZ3I.js";import{b as j,E as O,a as R}from"./el-input-Dwtsn4FB.js";import{E as q}from"./el-card-LZGPE6VU.js";import{d as G,p as f,C as H,g as J,w as o,t as e,s as C,y as Q,v as W,x as p,F as h,E as X,k as g,aD as Y,at as Z,aE as ee,z as i,o as ae,B as te}from"./index-BBqxh1Qt.js";import{P as oe}from"./PageLayout-CIMKISqz.js";import{r as ne,s as le}from"./api-D03_kbYf.js";import{E as se}from"./index-DlknRWU8.js";import"./mockData-C7SYYOmC.js";const re={class:"action-buttons"},ie={class:"pagination-container"},ue=G({__name:"PromotionCenterView",setup(pe){const u=async()=>{try{const n={page:l.value.page,pageSize:l.value.pageSize,name:s.value.name,status:s.value.status},a=await ne(n);v.value=a.list,l.value.total=a.total}catch(n){i.error("获取促销活动列表失败："+(n.message||"未知错误"))}},s=f({name:"",status:void 0}),l=f({page:1,pageSize:10,total:100}),v=f([]),d=async()=>{l.value.page=1,await u(),i.success("搜索完成")},E=async()=>{s.value={name:"",status:void 0},l.value.page=1,await u(),i.success("重置完成")},z=async n=>{l.value.pageSize=n,await u()},x=async n=>{l.value.page=n,await u()},S=()=>{i.success("新增促销活动功能已实现")},V=n=>{i.success(`编辑促销活动「${n.name}」功能已实现`)},k=async n=>{try{await se.confirm(`确定要删除促销活动「${n.name}」吗？此操作不可撤销。`,"删除确认",{confirmButtonText:"确定删除",cancelButtonText:"取消",type:"warning",customClass:"delete-confirm-message-box",confirmButtonClass:"delete-confirm-btn",distinguishCancelAndClose:!0,autofocus:!1}),await le(n.id),await u(),i.success("删除成功")}catch(a){a!=="cancel"&&a!=="close"&&i.error("删除失败："+(a.message||"未知错误"))}};return H(async()=>{await u()}),(n,a)=>{const B=R,m=O,_=$,P=U,c=M,T=j,w=q,r=A,y=L,b=X,I=N,D=K;return ae(),J(oe,{title:"促销中心",actions:[{type:"primary",text:"新增促销活动",icon:g(ee),onClick:S}]},{default:o(()=>[e(w,{shadow:"never",class:"search-form"},{default:o(()=>[e(T,{inline:!0,onSubmit:Q(d,["prevent"])},{default:o(()=>[e(m,{label:"活动名称"},{default:o(()=>[e(B,{modelValue:s.value.name,"onUpdate:modelValue":a[0]||(a[0]=t=>s.value.name=t),placeholder:"请输入活动名称",clearable:"",onKeyup:W(d,["enter"])},null,8,["modelValue"])]),_:1}),e(m,{label:"活动状态"},{default:o(()=>[e(P,{modelValue:s.value.status,"onUpdate:modelValue":a[1]||(a[1]=t=>s.value.status=t),placeholder:"请选择活动状态",clearable:""},{default:o(()=>[e(_,{label:"未开始",value:"pending"}),e(_,{label:"进行中",value:"active"}),e(_,{label:"已结束",value:"ended"})]),_:1},8,["modelValue"])]),_:1}),e(m,null,{default:o(()=>[e(c,{type:"primary",onClick:d},{default:o(()=>[...a[4]||(a[4]=[p("搜索",-1)])]),_:1}),e(c,{onClick:E},{default:o(()=>[...a[5]||(a[5]=[p("重置",-1)])]),_:1})]),_:1})]),_:1})]),_:1}),e(w,{shadow:"never",class:"table-container"},{default:o(()=>[e(I,{data:v.value,border:"",style:{width:"100%"}},{default:o(()=>[e(r,{prop:"id",label:"活动ID",width:"80",align:"center"}),e(r,{prop:"name",label:"活动名称","min-width":"200"}),e(r,{prop:"type",label:"活动类型",width:"120",align:"center"},{default:o(t=>[e(y,{type:t.row.type==="discount"?"primary":t.row.type==="coupon"?"success":"warning"},{default:o(()=>[p(h(t.row.type==="discount"?"折扣":t.row.type==="coupon"?"优惠券":"满减"),1)]),_:2},1032,["type"])]),_:1}),e(r,{prop:"startTime",label:"开始时间",width:"180"}),e(r,{prop:"endTime",label:"结束时间",width:"180"}),e(r,{prop:"status",label:"状态",width:"100",align:"center"},{default:o(t=>[e(y,{type:t.row.status==="pending"?"warning":t.row.status==="active"?"success":"info"},{default:o(()=>[p(h(t.row.status==="pending"?"未开始":t.row.status==="active"?"进行中":"已结束"),1)]),_:2},1032,["type"])]),_:1}),e(r,{label:"操作",width:"200",fixed:"right",align:"center"},{default:o(t=>[C("div",re,[e(c,{type:"primary",size:"small",onClick:F=>V(t.row)},{default:o(()=>[e(b,null,{default:o(()=>[e(g(Y))]),_:1}),a[6]||(a[6]=p(" 编辑 ",-1))]),_:1},8,["onClick"]),e(c,{type:"danger",size:"small",onClick:F=>k(t.row)},{default:o(()=>[e(b,null,{default:o(()=>[e(g(Z))]),_:1}),a[7]||(a[7]=p(" 删除 ",-1))]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["data"])]),_:1}),C("div",ie,[e(D,{"current-page":l.value.page,"onUpdate:currentPage":a[2]||(a[2]=t=>l.value.page=t),"page-size":l.value.pageSize,"onUpdate:pageSize":a[3]||(a[3]=t=>l.value.pageSize=t),"page-sizes":[10,20,50,100],total:l.value.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:z,onCurrentChange:x},null,8,["current-page","page-size","total"])])]),_:1},8,["actions"])}}}),Ce=te(ue,[["__scopeId","data-v-b794b5af"]]);export{Ce as default};
