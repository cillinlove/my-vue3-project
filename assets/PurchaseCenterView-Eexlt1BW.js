import{E as D}from"./el-button-Vc6VEKII.js";import{b as K,h as $,c as L,e as j,f as O}from"./el-table-column-DnVx5bAE.js";import{E as R}from"./el-tag-H94PFL3m.js";import{b as q,E as G,a as H}from"./el-input-CFf0CTHR.js";import{E as J}from"./el-card-CgDv5Emn.js";import{d as Q,p as f,C as W,g as X,w as t,s as g,t as e,y as Y,v as C,x as p,F as E,E as Z,k as v,aD as ee,at as ae,aE as te,z as d,o as le,B as oe}from"./index-ClAeb_nj.js";import{P as ne}from"./PageLayout-2dU49uLu.js";import{x as se,y as re}from"./api-D03_kbYf.js";import{E as ue}from"./index-Az46Y9ah.js";import"./mockData-C7SYYOmC.js";const pe={class:"purchase-center"},ie={class:"action-buttons"},de={class:"pagination-container"},ce=Q({__name:"PurchaseCenterView",setup(me){const s=f({orderNo:"",supplierName:"",status:void 0}),n=f({page:1,pageSize:10,total:0}),b=f([]),N=o=>({pending:"待审批",approved:"已审批",purchased:"已采购",completed:"已完成",cancelled:"已取消"})[o]||o,x=o=>({pending:"warning",approved:"info",purchased:"primary",completed:"success",cancelled:"danger"})[o]||"default",u=async()=>{try{const o={orderNo:s.value.orderNo,supplierName:s.value.supplierName,status:s.value.status,page:n.value.page,pageSize:n.value.pageSize},a=await se(o);b.value=a.list,n.value.total=a.total}catch{d.error("获取采购订单失败")}},c=async()=>{n.value.page=1,await u()},z=async()=>{s.value={orderNo:"",supplierName:"",status:void 0},n.value.page=1,await u()},S=async o=>{n.value.pageSize=o,await u()},V=async o=>{n.value.page=o,await u()},k=()=>{d.info("新增采购订单功能开发中")},B=o=>{d.success("编辑功能开发中")},P=async o=>{try{await ue.confirm(`确定要删除采购订单「${o.orderNo}」吗？此操作不可撤销。`,"删除确认",{confirmButtonText:"确定删除",cancelButtonText:"取消",type:"warning",customClass:"delete-confirm-message-box",confirmButtonClass:"delete-confirm-btn",distinguishCancelAndClose:!0,autofocus:!1}),await re(o.id),d.success("删除成功"),await u()}catch(a){a!=="cancel"&&a!=="close"&&d.error("删除失败："+(a.message||"未知错误"))}};return W(async()=>{await u()}),(o,a)=>{const w=H,m=G,i=$,T=K,_=D,M=q,y=J,r=j,A=R,h=Z,F=L,I=O;return le(),X(ne,{title:"采购中心",actions:[{type:"primary",text:"新增采购订单",icon:v(te),onClick:k}]},{default:t(()=>[g("div",pe,[e(y,{shadow:"never",class:"search-form"},{default:t(()=>[e(M,{inline:!0,onSubmit:Y(c,["prevent"])},{default:t(()=>[e(m,{label:"订单编号"},{default:t(()=>[e(w,{modelValue:s.value.orderNo,"onUpdate:modelValue":a[0]||(a[0]=l=>s.value.orderNo=l),placeholder:"请输入订单编号",clearable:"",onKeyup:C(c,["enter"])},null,8,["modelValue"])]),_:1}),e(m,{label:"供应商"},{default:t(()=>[e(w,{modelValue:s.value.supplierName,"onUpdate:modelValue":a[1]||(a[1]=l=>s.value.supplierName=l),placeholder:"请输入供应商名称",clearable:"",onKeyup:C(c,["enter"])},null,8,["modelValue"])]),_:1}),e(m,{label:"订单状态"},{default:t(()=>[e(T,{modelValue:s.value.status,"onUpdate:modelValue":a[2]||(a[2]=l=>s.value.status=l),placeholder:"请选择订单状态",clearable:""},{default:t(()=>[e(i,{label:"待审批",value:"pending"}),e(i,{label:"已审批",value:"approved"}),e(i,{label:"已采购",value:"purchased"}),e(i,{label:"已完成",value:"completed"}),e(i,{label:"已取消",value:"cancelled"})]),_:1},8,["modelValue"])]),_:1}),e(m,null,{default:t(()=>[e(_,{type:"primary",onClick:c},{default:t(()=>[...a[5]||(a[5]=[p("搜索",-1)])]),_:1}),e(_,{onClick:z},{default:t(()=>[...a[6]||(a[6]=[p("重置",-1)])]),_:1})]),_:1})]),_:1})]),_:1}),e(y,{shadow:"never",class:"table-container"},{default:t(()=>[e(F,{data:b.value,border:"",style:{width:"100%"}},{default:t(()=>[e(r,{prop:"id",label:"ID",width:"60",align:"center"}),e(r,{prop:"orderNo",label:"订单编号",width:"180"}),e(r,{prop:"supplierName",label:"供应商","min-width":"150"}),e(r,{prop:"totalAmount",label:"订单金额",width:"120",align:"center"},{default:t(l=>[p(" ¥"+E(l.row.totalAmount.toFixed(2)),1)]),_:1}),e(r,{prop:"status",label:"状态",width:"100",align:"center"},{default:t(l=>[e(A,{type:x(l.row.status)},{default:t(()=>[p(E(N(l.row.status)),1)]),_:2},1032,["type"])]),_:1}),e(r,{prop:"createdAt",label:"创建时间",width:"180"}),e(r,{label:"操作",width:"200",fixed:"right",align:"center"},{default:t(l=>[g("div",ie,[e(_,{type:"primary",size:"small",onClick:U=>B(l.row)},{default:t(()=>[e(h,null,{default:t(()=>[e(v(ee))]),_:1}),a[7]||(a[7]=p(" 编辑 ",-1))]),_:1},8,["onClick"]),e(_,{type:"danger",size:"small",onClick:U=>P(l.row)},{default:t(()=>[e(h,null,{default:t(()=>[e(v(ae))]),_:1}),a[8]||(a[8]=p(" 删除 ",-1))]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["data"])]),_:1}),g("div",de,[e(I,{"current-page":n.value.page,"onUpdate:currentPage":a[3]||(a[3]=l=>n.value.page=l),"page-size":n.value.pageSize,"onUpdate:pageSize":a[4]||(a[4]=l=>n.value.pageSize=l),"page-sizes":[10,20,50,100],total:n.value.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:S,onCurrentChange:V},null,8,["current-page","page-size","total"])])])]),_:1},8,["actions"])}}}),Ne=oe(ce,[["__scopeId","data-v-e4b431ad"]]);export{Ne as default};
