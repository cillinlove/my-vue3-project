import{E as H}from"./el-button-DVrV4cDQ.js";import{E as L}from"./el-card-LZGPE6VU.js";import{E as j}from"./el-tag-fQWpZZ3I.js";import{b as z,a3 as Y,bx as R,_ as J,d as O,aJ as X,e as K,p as Q,c as E,g,o as u,w as i,aG as b,s,n as S,k as t,h,E as M,r as q,j as Z,f as P,x as o,F as c,X as G,t as m,bw as x,aO as ee,U as se,l as te,m as U,cE as B,cF as ne,ar as oe,z as ie,A as re,b8 as le,B as ue}from"./index-BBqxh1Qt.js";const ae=["light","dark"],de=z({title:{type:String,default:""},description:{type:String,default:""},type:{type:String,values:Y(R),default:"info"},closable:{type:Boolean,default:!0},closeText:{type:String,default:""},showIcon:Boolean,center:Boolean,effect:{type:String,values:ae,default:"light"},showAfter:Number,hideAfter:Number,autoClose:Number}),pe={close:f=>f instanceof MouseEvent},me=O({name:"ElAlert",__name:"alert",props:de,emits:pe,setup(f,{emit:_}){const{Close:w}=x,p=f,T=_,V=X(),l=K("alert"),r=Q(!0),a=E(()=>R[p.type]),v=E(()=>!!(p.description||V.default)),A=n=>{r.value=!1,T("close",n)};return p.showAfter||p.hideAfter||p.autoClose,(n,N)=>(u(),g(se,{name:t(l).b("fade"),persisted:""},{default:i(()=>[b(s("div",{class:S([t(l).b(),t(l).m(n.type),t(l).is("center",n.center),t(l).is(n.effect)]),role:"alert"},[n.showIcon&&(n.$slots.icon||a.value)?(u(),g(t(M),{key:0,class:S([t(l).e("icon"),t(l).is("big",v.value)])},{default:i(()=>[q(n.$slots,"icon",{},()=>[(u(),g(Z(a.value)))])]),_:3},8,["class"])):h("v-if",!0),s("div",{class:S(t(l).e("content"))},[n.title||n.$slots.title?(u(),P("span",{key:0,class:S([t(l).e("title"),{"with-description":v.value}])},[q(n.$slots,"title",{},()=>[o(c(n.title),1)])],2)):h("v-if",!0),v.value?(u(),P("p",{key:1,class:S(t(l).e("description"))},[q(n.$slots,"default",{},()=>[o(c(n.description),1)])],2)):h("v-if",!0),n.closable?(u(),P(G,{key:2},[n.closeText?(u(),P("div",{key:0,class:S([t(l).e("close-btn"),t(l).is("customed")]),onClick:A},c(n.closeText),3)):(u(),g(t(M),{key:1,class:S(t(l).e("close-btn")),onClick:A},{default:i(()=>[m(t(w))]),_:1},8,["class"]))],64)):h("v-if",!0)],2)],2),[[ee,r.value]])]),_:3},8,["name"]))}});var ce=J(me,[["__file","/home/runner/work/element-plus/element-plus/packages/components/alert/src/alert.vue"]]);const fe=te(ce),d={DASHBOARD_VIEW:"dashboard_view",PRODUCT_VIEW:"product_view",USER_VIEW:"user_view",ORDER_VIEW:"order_view",SYSTEM_VIEW:"system_view",SETTINGS_VIEW:"settings_view"},W=[{id:"dashboard",title:"仪表盘",icon:"Odometer",path:"/",requiredPermissions:[d.DASHBOARD_VIEW]},{id:"products",title:"商品管理",icon:"Goods",path:"/products/manage",requiredPermissions:[d.PRODUCT_VIEW]},{id:"orders",title:"订单管理",icon:"List",path:"/orders",requiredPermissions:[d.ORDER_VIEW]},{id:"users",title:"用户管理",icon:"User",path:"/user-center",requiredPermissions:[d.USER_VIEW]},{id:"sales",title:"销售报表",icon:"TrendCharts",path:"/sales",requiredPermissions:[d.DASHBOARD_VIEW]},{id:"promotions",title:"促销管理",icon:"Discount",path:"/promotion-center",requiredPermissions:[d.SETTINGS_VIEW]},{id:"content",title:"内容管理",icon:"Document",path:"/content-management",requiredPermissions:[d.SETTINGS_VIEW]},{id:"purchase",title:"采购中心",icon:"ShoppingCart",path:"/purchase-center",requiredPermissions:[d.SETTINGS_VIEW]},{id:"warehouse",title:"仓库管理",icon:"OfficeBuilding",path:"/wms-warehouse",requiredPermissions:[d.SETTINGS_VIEW]},{id:"dispatch",title:"调度中心",icon:"Van",path:"/dispatch-center",requiredPermissions:[d.SETTINGS_VIEW]},{id:"logistics",title:"物流中心",icon:"Location",path:"/logistics-center",requiredPermissions:[d.SETTINGS_VIEW]},{id:"system",title:"系统管理",icon:"Setting",path:"/permission-management",requiredPermissions:[d.SYSTEM_VIEW]},{id:"settings",title:"个人设置",icon:"UserFilled",path:"/settings",requiredPermissions:[d.SETTINGS_VIEW]}];function ve(){const f=U(),_=r=>{if(!f.userInfo)return!1;if(f.userInfo.role==="admin")return!0;const a=f.userInfo.permissions||[];return typeof r=="string"?a.includes(r):Array.isArray(r)?r.every(v=>a.includes(v)):!1},w=E(()=>W.filter(r=>_(r.requiredPermissions))),p=E(()=>w.value.map(r=>({...r,isVisible:!0,hasChildren:!1}))),T=E(()=>({totalItems:W.length,visibleItems:p.value.length,hiddenItems:W.length-p.value.length,adminAccess:f.userInfo?.role==="admin"}));return{menuItems:p,stats:T,hasPermission:_,isMenuItemVisible:r=>{const a=W.find(v=>v.path===r);return a?_(a.requiredPermissions):!1},getMenuItemsByPermission:r=>p.value.filter(a=>a.requiredPermissions.includes(r)),isAdmin:E(()=>f.userInfo?.role==="admin")}}const ye={class:"permission-demo"},ge={class:"demo-header"},Ie={class:"user-info"},Ee={class:"demo-content"},_e={class:"demo-section"},we={class:"menu-list"},Se={class:"demo-section"},be={class:"button-group"},Pe={class:"demo-section"},Te={class:"permission-check"},Ce={class:"check-result"},ke={class:"check-result"},Ve={class:"demo-section"},Ae={class:"admin-buttons"},De={class:"demo-section"},he=O({__name:"PermissionDemoView",setup(f){const _=re(),w=U(),{menuItems:p}=ve(),T=B("dashboard_view"),V=B("product_create"),l=B("user_delete"),r=ne(),a=E(()=>r.hasAll(["product_view","product_edit"])),v=E(()=>r.hasAny(["product_create","user_delete"])),A=D=>({dashboard_view:"primary",product_view:"success",product_create:"warning",user_view:"info",user_delete:"danger",system_view:"danger"})[D]||"default",n=D=>{ie.success(`您点击了: ${D}`)},N=()=>{_.push("/permission-management")};return(D,e)=>{const C=j,I=H,$=L,F=fe,k=le("permission");return u(),P("div",ye,[s("div",ge,[e[10]||(e[10]=s("h1",null,"权限系统演示页面",-1)),s("div",Ie,[s("p",null,[e[7]||(e[7]=s("strong",null,"用户名:",-1)),o(" "+c(t(w).userInfo?.username),1)]),s("p",null,[e[8]||(e[8]=s("strong",null,"角色:",-1)),o(" "+c(t(w).userInfo?.role),1)]),s("p",null,[e[9]||(e[9]=s("strong",null,"权限:",-1)),o(" "+c(t(w).userInfo?.permissions?.join(", ")),1)])])]),s("div",Ee,[s("section",_e,[e[11]||(e[11]=s("h2",null,"1. 路由权限演示",-1)),e[12]||(e[12]=s("p",null,"当前用户可以访问的菜单项：",-1)),s("div",we,[(u(!0),P(G,null,oe(t(p),y=>(u(),g(C,{key:y.id,class:"menu-item",type:A(y.requiredPermissions?.[0]||"dashboard_view")},{default:i(()=>[o(c(y.title),1)]),_:2},1032,["type"]))),128))]),e[13]||(e[13]=s("p",{class:"note"},"* 只有具有相应权限的用户才能看到这些菜单项",-1))]),s("section",Se,[e[18]||(e[18]=s("h2",null,"2. v-permission自定义指令演示",-1)),e[19]||(e[19]=s("p",null,"根据权限显示/隐藏按钮：",-1)),s("div",be,[b((u(),g(I,{type:"primary",onClick:e[0]||(e[0]=y=>n("仪表盘查看权限"))},{default:i(()=>[...e[14]||(e[14]=[o(" 查看仪表盘 ",-1)])]),_:1})),[[k,"dashboard_view"]]),b((u(),g(I,{type:"success",onClick:e[1]||(e[1]=y=>n("商品创建权限"))},{default:i(()=>[...e[15]||(e[15]=[o(" 创建商品 ",-1)])]),_:1})),[[k,"product_create"]]),b((u(),g(I,{type:"danger",onClick:e[2]||(e[2]=y=>n("用户删除权限"))},{default:i(()=>[...e[16]||(e[16]=[o(" 删除用户 ",-1)])]),_:1})),[[k,"user_delete"]]),b((u(),g(I,{type:"warning",onClick:e[3]||(e[3]=y=>n("商品查看+编辑权限"))},{default:i(()=>[...e[17]||(e[17]=[o(" 查看编辑商品 ",-1)])]),_:1})),[[k,["product_view","product_edit"]]])]),e[20]||(e[20]=s("p",{class:"note"},"* 只有具有相应权限的用户才能看到对应的按钮",-1))]),s("section",Pe,[e[28]||(e[28]=s("h2",null,"3. 权限检查函数演示",-1)),e[29]||(e[29]=s("p",null,"使用usePermission和useBatchPermission函数：",-1)),s("div",Te,[m($,{class:"permission-card"},{header:i(()=>[...e[21]||(e[21]=[s("span",null,"单个权限检查",-1)])]),default:i(()=>[s("div",Ce,[s("p",null,[e[22]||(e[22]=o("dashboard_view: ",-1)),m(C,{type:t(T)?"success":"danger"},{default:i(()=>[o(c(t(T)?"有权限":"无权限"),1)]),_:1},8,["type"])]),s("p",null,[e[23]||(e[23]=o("product_create: ",-1)),m(C,{type:t(V)?"success":"danger"},{default:i(()=>[o(c(t(V)?"有权限":"无权限"),1)]),_:1},8,["type"])]),s("p",null,[e[24]||(e[24]=o("user_delete: ",-1)),m(C,{type:t(l)?"success":"danger"},{default:i(()=>[o(c(t(l)?"有权限":"无权限"),1)]),_:1},8,["type"])])])]),_:1}),m($,{class:"permission-card"},{header:i(()=>[...e[25]||(e[25]=[s("span",null,"批量权限检查",-1)])]),default:i(()=>[s("div",ke,[s("p",null,[e[26]||(e[26]=o("所有权限 [product_view, product_edit]: ",-1)),m(C,{type:a.value?"success":"danger"},{default:i(()=>[o(c(a.value?"有权限":"无权限"),1)]),_:1},8,["type"])]),s("p",null,[e[27]||(e[27]=o("任一权限 [product_create, user_delete]: ",-1)),m(C,{type:v.value?"success":"danger"},{default:i(()=>[o(c(v.value?"有权限":"无权限"),1)]),_:1},8,["type"])])])]),_:1})])]),s("section",Ve,[e[34]||(e[34]=s("h2",null,"4. 管理员功能演示",-1)),e[35]||(e[35]=s("p",null,"只有管理员才能看到的内容：",-1)),b((u(),g(F,{title:"管理员专用功能区域",type:"warning",closable:!1,"show-icon":""},{default:i(()=>[...e[30]||(e[30]=[s("p",null,"这里只有拥有system_view权限的用户才能看到。",-1)])]),_:1})),[[k,"system_view"]]),b((u(),P("div",Ae,[m(I,{type:"danger",onClick:e[4]||(e[4]=y=>n("系统设置功能"))},{default:i(()=>[...e[31]||(e[31]=[o("系统设置",-1)])]),_:1}),m(I,{type:"warning",onClick:e[5]||(e[5]=y=>n("用户管理功能"))},{default:i(()=>[...e[32]||(e[32]=[o("用户管理",-1)])]),_:1}),m(I,{type:"info",onClick:e[6]||(e[6]=y=>n("权限分配功能"))},{default:i(()=>[...e[33]||(e[33]=[o("权限分配",-1)])]),_:1})])),[[k,"system_view"]])]),s("section",De,[e[37]||(e[37]=s("h2",null,"5. 权限测试",-1)),e[38]||(e[38]=s("p",null,"测试没有权限时的处理：",-1)),m(I,{onClick:N},{default:i(()=>[...e[36]||(e[36]=[o("测试403页面",-1)])]),_:1}),e[39]||(e[39]=s("p",{class:"note"},"* 如果用户没有权限，路由守卫会自动跳转到403页面",-1))])])])}}}),$e=ue(he,[["__scopeId","data-v-5b331f54"]]);export{$e as default};
